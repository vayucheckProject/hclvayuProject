<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sidebar Example</title>
    <link rel="stylesheet" href="/navbar.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

    <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
    
    rel="stylesheet"
  />
   <style>/* Sidebar styles */
   .map-section {
            width: 50%; /* Full width of the container */
            height: 400px; /* Adjust height as per your requirement */
            margin: 20px auto; /* Optional: Center the map container */
            border: 2px solid #ccc; /* Optional: Styling for the container */
        }

        #map {
            height: 100%; /* Make map fill the container */
            width: 100%; /* Full width of the parent container */
        }

    .sidebar {
      width: 200px;
      color: black;
      background-color: rgba(240, 238, 238, 0.904);
      padding: 18px;
      height: 100vh;
      display: flex;
      flex-direction: column;
      gap: 5px;
      color: white;
    }
    
    .sidebar-btn {
      background: none;
      border: none;
      color: #1976D2;
      font-size: 17px;
      cursor: pointer;
      font-weight: 600 ;
      padding: 10px;
      text-align: left;
      border-radius: 4px;
      transition: background 0.3s;
    }
    
    .sidebar-btn:hover {
      color: white;
      background-color: #005cb2;
    }
    
    .sidebar-btn.active {
      background-color: #1976D2;
      color: white;
      font-weight: bold;
    }
    
    /* Content styles */
    .content {
     
      padding: 20px;
    }
    
    .page {
      display: none;
    }
    
    .page.active {
      display: block;
    }
    .city-input-container {
  max-width: 550px;
  margin: 20px auto;
  padding: 10px;
  text-align: center;
}

.city-input {
  border: 2px solid #fff;
  background-color: white;
  border-radius: 50px;
  padding: 15px;
  font-size: 1.1rem;
  outline: none;
  text-align: center;
  color: #333;
  background-color: rgba(255, 255, 255, 0.2);
  box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.2);
  transition: all 0.3s ease;
}

.city-input::placeholder {
  color: #fff;
  opacity: 0.6;
}

.city-input:focus {
  border-color: #0D47A1;
  background-color: rgba(255, 255, 255, 0.3);
  box-shadow: 0px 8px 16px rgba(13, 71, 161, 0.4);
}

.btn-gradient {
  background: linear-gradient(135deg, #0D47A1, #1976D2);
  border: none;
  font-size: 1.2rem;
  padding: 14px 30px;
  border-radius: 50px;
  transition: all 0.3s ease-in-out;
  cursor: pointer;
  box-shadow: 0px 8px 20px rgba(0, 0, 0, 0.3);
  text-transform: uppercase;
}

.btn-gradient:hover {
  background: linear-gradient(135deg, #1E88E5, #0D47A1);
  transform: translateY(-5px);
  box-shadow: 0px 12px 24px rgba(0, 0, 0, 0.4);
}

.weather-widget {
  background-color: rgba(0, 0, 0, 0.2); /* Set the widget background */
  border: none;
  border-radius: 20px;
  overflow: hidden;
  box-shadow: 0px 20px 40px rgba(0, 0, 0, 0.3);
  max-width: 500px;
  width: 100%;
  margin: 20px auto;
  transition: all 0.4s ease-in-out;
  transform: scale(0.98);
  background: linear-gradient(135deg, #1976D2, #0D47A1); 
  /* Gradient background for the widget */
  position: absolute;
  top: 91px;
}

.weather-widget:hover {
  transform: scale(1);
  box-shadow: 0px 30px 60px rgba(0, 0, 0, 0.4);
}

.weather-bg {
  position: relative;
  background: url('/default-cloud.jpg') center/cover no-repeat;
  background-size: cover;
  padding: 40px 30px;
  border-radius: 20px;
  transition: all 0.4s ease-in-out;
  text-align: center;
}

.widget-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
}

.city-name {
  font-size: 2.3rem;
  font-weight: 800;
  letter-spacing: 1px;
  text-transform: uppercase;
  color: #fff;
}

.weather-icon {
  width: 90px;
  transition: transform 0.4s ease-in-out;
}

.weather-icon:hover {
  transform: rotate(360deg);
}

.weather-details {
  margin-top: 15px;
}

.weather-description {
  font-size: 1.3rem;
  text-transform: capitalize;
  font-weight: 600;
  margin-bottom: 15px;
  color: rgba(255, 255, 255, 0.8);
}

.temperature {
  font-size: 4.5rem;
  font-weight: 800;
  color: #fff;
  margin: 20px 0;
  letter-spacing: 2px;
}

.additional-info p {
  font-size: 1.1rem;
  font-weight: 500;
  margin: 5px 0;
  color: rgba(255, 255, 255, 0.8);
}

.additional-info span {
  font-weight: 700;
}

@media (max-width: 576px) {
  .weather-widget {
    max-width: 100%;
  }

  .city-name {
    font-size: 1.8rem;
  }

  .temperature {
    font-size: 3.5rem;
  }

  .weather-description {
    font-size: 1.2rem;
  }

  .additional-info p {
    font-size: 1rem;
  }
}

    </style>
  </head>
  <body>
    <div class="sidebar">
      <div class="logo">
        <img src="/वाU check img.png" alt="logo" />
      </div>
      <button class="sidebar-btn" data-target="home">Home</button>
      <button class="sidebar-btn" data-target="current-air-quality">Current Air Quality</button>
      <button class="sidebar-btn" data-target="air-quality-prediction">Air Quality Prediction</button>
      <button class="sidebar-btn" data-target="live-map">Live Map</button>
      <button class="sidebar-btn" data-target="content">Content</button>
      <button class="sidebar-btn" data-target="help">Help</button>
    </div>
    <div class="content">
      <div id="home" class="page active">
        
        <p>Welcome to the Home Page!</p>
      
      </div>
      <div id="current-air-quality" class="page">
        
        
        <div class="container mt-5">
          <!-- Input for City -->
          <section class="home">
            <h1>Current Air Quality</h1>
            <div class="homeHeader">
              <label for="city-input">Enter City Name:</label>
              <input
                type="text"
                id="city-input"
                class="form-control city-input"
                placeholder="e.g., London"
              />
              <button id="fetch-weather-btn" class="btn btn-primary mt-3">Show Air Quality</button>
            </div>
          </section>
          <section class="airdata">

 <!-- Weather Widget -->
  <div class="widgetsection">
    <div class="weather-widget card">
      <div class="card-body">
        <div id="weather-background" class="weather-bg">
          <div class="widget-header">
            <h2 id="city-name" class="city-name">City Name</h2>
            <img id="weather-icon" class="weather-icon" alt="Weather Icon" />
          </div>
          <div class="weather-details">
            <p id="weather-description" class="weather-description">Description</p>
            <h1 id="temperature" class="temperature">0°C</h1>
            <div class="additional-info">
              <p><strong>Wind:</strong> <span id="wind-speed">0 km/h</span></p>
              <p><strong>Humidity:</strong> <span id="humidity">0%</span></p>
              <p><strong>Pressure:</strong> <span id="pressure">0 hPa</span></p>
            </div>
          </div>
        </div>
      </div>
    </div>
    </div>

  </div>

<div class="airdataTable">
  <table id="result-table" class="hidden">
    <thead>
      <tr>
        <th>Component</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>
          </section>
      
         
       
      </div>
      <div id="air-quality-prediction" class="page">
        <h1>Air Quality Prediction</h1>
        <p>Details about air quality prediction go here.</p>
      </div>
      <div id="live-map" class="page">
         <!-- Section where the map is displayed -->
    <div class="map-section">
      <div id="map"></div>
  </div>
      </div>
      <div id="content" class="page">
        <h1>Content</h1>
        <p>Details about content go here.</p>
      </div>
      <div id="help" class="page">
        <h1>Help</h1>
        <p>Help content goes here.</p>
      </div>
    </div>
  

<script>
  // Select all sidebar buttons and content pages
const buttons = document.querySelectorAll('.sidebar-btn');
const pages = document.querySelectorAll('.page');

// Add event listeners to sidebar buttons
buttons.forEach((button) => {
  button.addEventListener('click', () => {
    // Remove 'active' class from all buttons
    buttons.forEach((btn) => btn.classList.remove('active'));

    // Add 'active' class to the clicked button
    button.classList.add('active');

    // Get the target page from the data-target attribute
    const target = button.getAttribute('data-target');

    // Hide all pages
    pages.forEach((page) => page.classList.remove('active'));

    // Show the selected page
    document.getElementById(target).classList.add('active');
  });
});

</script>
<script>

  const apiKey = '6309a7fdbbb54a28d9342fa4859e15c0';

  // Function to fetch weather data
  function fetchWeather(city) {
    const apiUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&appid=${apiKey}`;

    fetch(apiUrl)
      .then((response) => response.json())
      .then((data) => {
        if (data.cod === 200) {
          updateWeatherWidget(data);
        } else {
          alert('City not found. Please try again.');
        }
      })
      .catch((error) => {
        console.error('Error fetching weather data:', error);
        alert('Unable to fetch weather data. Please try again later.');
      });
  }

  // Function to update the weather widget
  function updateWeatherWidget(data) {
    const cityName = data.name;
    const temperature = Math.round(data.main.temp);
    const weatherDescription = data.weather[0].description;
    const weatherIconCode = data.weather[0].icon;
    const windSpeed = data.wind.speed;
    const humidity = data.main.humidity;
    const pressure = data.main.pressure;

    // Update the widget content
    document.getElementById('city-name').textContent = cityName;
    document.getElementById('temperature').textContent = `${temperature}°C`;
    document.getElementById('weather-description').textContent = weatherDescription;
    document.getElementById('wind-speed').textContent = `${windSpeed} km/h`;
    document.getElementById('humidity').textContent = `${humidity}%`;
    document.getElementById('pressure').textContent = `${pressure} hPa`;

    // Update the weather icon
    document.getElementById('weather-icon').src = `http://openweathermap.org/img/wn/${weatherIconCode}@2x.png`;

    // Dynamically update the background
    const weatherBackground = document.getElementById('weather-background');
    if (weatherDescription.includes('cloud')) {
      weatherBackground.style.backgroundImage = "url('/cloudy-bg.jpg')";
    } else if (weatherDescription.includes('rain')) {
      weatherBackground.style.backgroundImage = "url('/rainy-bg.jpg')";
    } else if (weatherDescription.includes('clear')) {
      weatherBackground.style.backgroundImage = "url('/clear-bg.jpg')";
    } else {
      weatherBackground.style.backgroundImage = "url('/default-cloud.jpg')";
    }
  }

  // Function to fetch air pollution data based on city coordinates
  async function fetchAirPollution(city) {
    const geoApiUrl = `https://api.openweathermap.org/geo/1.0/direct?q=${city}&limit=1&appid=${apiKey}`;

    try {
      const geoResponse = await fetch(geoApiUrl);
      const geoData = await geoResponse.json();
      if (geoData.length === 0) {
        alert('City not found.');
        return;
      }

      const { lat, lon } = geoData[0];
      const airPollutionApiUrl = `https://api.openweathermap.org/data/2.5/air_pollution?lat=${lat}&lon=${lon}&appid=${apiKey}`;

      const airPollutionResponse = await fetch(airPollutionApiUrl);
      const airPollutionData = await airPollutionResponse.json();

      // Extract components from the air pollution data
      const components = airPollutionData.list[0].components;
      const tableBody = document.querySelector("#result-table tbody");
      tableBody.innerHTML = ""; // Clear previous results

      // Populate the table with air quality data
      for (const [component, value] of Object.entries(components)) {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${component}</td>
          <td>${value.toFixed(2)}</td>
        `;
        tableBody.appendChild(row);
      }

      // Show the table
      document.getElementById("result-table").classList.remove("hidden");
    } catch (error) {
      console.error("Error fetching air pollution data:", error);
      alert("An error occurred while fetching air pollution data. Please try again later.");
    }
  }

  // Event listener for fetching both weather and air quality data
  document.getElementById('fetch-weather-btn').addEventListener('click', () => {
    const cityInput = document.getElementById('city-input').value.trim();
    if (cityInput) {
      // Fetch both weather and air pollution data when the button is clicked
      fetchWeather(cityInput);
      fetchAirPollution(cityInput);
    } else {
      alert('Please enter a city name.');
    }
  });
   // Initialize the map with a default center (Delhi coordinates) and zoom level 10
   const map = L.map('map').setView([28.6139, 77.2090], 10);

// Add a tile layer from OpenStreetMap with a max zoom level of 19
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '© OpenStreetMap'
}).addTo(map);

// API Key and URL for Air Quality Data (OpenWeather API)

const url = `https://api.openweathermap.org/data/2.5/air_pollution?lat=28.6139&lon=77.2090&appid=${apiKey}`;

// Fetch air pollution data
fetch(url)
    .then(response => {
        if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
        return response.json();
    })
    .then(data => {
        console.log('API Response:', data);
        const { list } = data;
        const pollution = list[0].main.aqi;
        const aqiText = ['Unknown', 'Good', 'Fair', 'Moderate', 'Poor', 'Very Poor'][pollution] || 'Unknown';

        // Add a marker with a popup to the map
        L.marker([28.6139, 77.2090])
            .addTo(map)
            .bindPopup(`Air Quality Index: ${pollution} (${aqiText})`)
            .openPopup();
    })
    .catch(error => console.error('API Fetch Error:', error));

// Dynamic fetch on map click (to get air quality at clicked coordinates)
map.on('click', function(e) {
    const { lat, lng } = e.latlng;
    console.log(`Clicked Location: lat=${lat}, lon=${lng}`);
    const dynamicUrl = `https://api.openweathermap.org/data/2.5/air_pollution?lat=${lat}&lon=${lng}&appid=${apiKey}`;

    fetch(dynamicUrl)
        .then(response => {
            if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
            return response.json();
        })
        .then(data => {
            console.log('Dynamic API Response:', data);
            const { list } = data;
            const pollution = list[0].main.aqi;
            const aqiText = ['Unknown', 'Good', 'Fair', 'Moderate', 'Poor', 'Very Poor'][pollution] || 'Unknown';

            // Add a marker to the clicked location with popup showing AQI info
            L.marker([lat, lng])
                .addTo(map)
                .bindPopup(`Air Quality Index: ${pollution} (${aqiText})`)
                .openPopup();
        })
        .catch(error => console.error('Dynamic API Fetch Error:', error));
});
</script>


</script>
<script>
 
</script>

    <script src="/script.js">
    </script>
  </body>
</html>
